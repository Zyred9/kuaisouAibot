# 用户接口文档

> 模块：search_bot 用户管理接口
> 说明：本文梳理 `UserController` 下的用户相关接口，适用于前后端及三方系统对接。
> 所有接口统一返回包装类型 `Result<T>`，其中 `code`/`msg`/`data` 结构以系统约定为准。

---

## 一、通用数据结构说明

### 1. 分页结果 `Page<T>`（MyBatis-Plus）

`/user/page` 接口中，`data` 字段为 `Page<User>`，主要字段说明：

- `current`：当前页码，从 1 开始。
- `size`：每页条数。
- `total`：总记录数。
- `pages`：总页数。
- `records`：当前页的数据列表（本接口为 `User` 数组）。

### 2. 用户对象 `User` 字段说明

`records` 中每一项为一个 `User` 对象，字段含义：

- `userId`：用户ID，系统内用户唯一标识。
- `username`：用户名，一般为用户在系统中的登录名/标识。
- `nickname`：用户昵称，用于展示。
- `registerTime`：注册时间，格式为后端配置的日期时间格式（如 `yyyy-MM-dd HH:mm:ss`）。
- `inviteCode`：邀请码，用于邀请注册或推广关系绑定。
- `trAddr`：TRC20 地址，用于链上收款 / 提现等。
- `grade`：广告等级，枚举 `AdvertisingGradeEnum`，取值含义：
  - `A`：A级代理
  - `B`：B级代理
  - `C`：C级代理
  - `D`：D级代理
  - `E`：E级代理
- `balance`：用户当前总余额（金额，后端使用 BigDecimal 存储）。
- `underwayAmount`：待入账金额（尚未结算到余额的金额）。
- `withdrawAmount`：累计提现总金额。
- `awardAmount`：累计奖励总金额。
- `totalRechargeAmount`：累计充值总金额。
- `parentId`：上级用户ID，用于普通邀请关系链路。
- `adsParentId`：广告上级用户ID，用于广告相关的上级关系（例如推广代理）。
- `todayAward`：今日待入账奖励金额。
- `totalAward`：总待入账奖励金额。
- `accumulativeTotalAward`：累计已入账奖励金额。

> 说明：金额相关字段全部为数值类型（BigDecimal），对接时按数字传输和解析即可。

---

## 二、用户管理接口（`UserController`）

- 基础路径：`/user`

### 1. 用户分页查询

- 请求方法：GET  
- 请求路径：`/user/page`  
- 接口描述：分页查询用户列表，支持根据用户ID、用户名进行搜索。

请求参数（Query Params）：

- `current`（Integer，可选，默认值：1）
  - 含义：当前页码，从 1 开始。
- `size`（Integer，可选，默认值：10）
  - 含义：每页返回的记录条数。
- `userId`（Long，可选）
  - 含义：用户ID，精准匹配 `User.userId`。
  - 说明：若填写，则只返回该用户ID对应的记录。
- `username`（String，可选）
  - 含义：用户名，模糊匹配 `User.username`。
  - 说明：支持部分匹配，例如 `abc` 可以匹配用户名中包含 `abc` 的用户。

响应数据：`Result<Page<User>>`

- `data.current`：当前页码。
- `data.size`：每页条数。
- `data.total`：总记录数。
- `data.pages`：总页数。
- `data.records`：用户数据列表，每一项为上文所述的 `User` 对象。

---

### 2. 编辑用户信息

- 请求方法：POST  
- 请求路径：`/user/edit`  
- 接口描述：编辑用户的广告等级与余额信息。

请求体（Request Body）：`UserEditVO`

```json
{
  "userId": 10001,
  "grade": "B",
  "balance": 123.45
}
```

`UserEditVO` 字段说明：

- `userId`（Long，必填）
  - 含义：用户ID，指定需要被编辑的用户。
  - 规则：
    - 为空时，接口返回错误：`"用户ID不能为空"`。
    - 若数据库中不存在此用户，接口返回错误：`"用户不存在"`。

- `grade`（String，对应枚举 `AdvertisingGradeEnum`，可选）
  - 含义：广告等级。
  - 取值：枚举名（大小写敏感），取值范围：`"A"`、`"B"`、`"C"`、`"D"`、`"E"`。
  - 业务说明：
    - 为空：不修改用户当前广告等级。
    - 非空：将用户广告等级更新为对应等级。

- `balance`（Number，对应 BigDecimal，可选）
  - 含义：用户总余额。
  - 业务说明：
    - 为空：不修改当前余额。
    - 非空：直接将用户余额更新为该数值（覆盖原值）。

业务规则汇总：

1. 仅允许修改 `grade`、`balance` 两个字段，其他用户信息不会被本接口修改。  
2. 请求成功且通过校验后，后端会根据 `userId` 查询用户并进行字段更新，最终返回成功结果。  

响应数据：`Result<Void>`

- 成功：`code` 为系统约定的成功码，`data` 为空。  
- 失败：`code` 为错误码，`msg` 中包含错误提示，如：`"用户ID不能为空"`、`"用户不存在"` 等。
